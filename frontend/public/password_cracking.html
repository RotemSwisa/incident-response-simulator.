<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Cracking Lab - IR Simulator</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        .terminal {
            font-family: 'Courier New', monospace;
            background: #0d1117;
            color: #58a6ff;
            padding: 20px;
            border-radius: 8px;
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
        }
        .terminal-input {
            background: transparent;
            border: none;
            color: #58a6ff;
            font-family: 'Courier New', monospace;
            outline: none;
            width: calc(100% - 200px);
        }
        .terminal-line {
            margin-bottom: 4px;
            white-space: pre-wrap;
            word-break: break-all;
        }
        .command { color: #58a6ff; }
        .output { color: #c9d1d9; }
        .error { color: #f85149; }
        .success { color: #3fb950; }
        .warning { color: #d29922; }
        .prompt { color: #79c0ff; font-weight: bold; }
        .cracked { color: #3fb950; font-weight: bold; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const PasswordCrackingLab = () => {
            const [stage, setStage] = useState('intro');
            const [acceptedEthics, setAcceptedEthics] = useState(false);
            const [labRunning, setLabRunning] = useState(false);
            const [terminalHistory, setTerminalHistory] = useState([]);
            const [currentCommand, setCurrentCommand] = useState('');
            const [commandHistory, setCommandHistory] = useState([]);
            const [historyIndex, setHistoryIndex] = useState(-1);
            const [loading, setLoading] = useState(false);
            const [startTime, setStartTime] = useState(null);
            const [hintsUsed, setHintsUsed] = useState(0);
            const [crackedCount, setCrackedCount] = useState(0);
            const [score, setScore] = useState(null);
            const terminalRef = useRef(null);
            const inputRef = useRef(null);

            const API_BASE = 'http://localhost:8000';

            useEffect(() => {
                if (terminalRef.current) {
                    terminalRef.current.scrollTop = terminalRef.current.scrollHeight;
                }
            }, [terminalHistory]);

            const startLab = async () => {
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE}/hashcrack/start`, {
                        method: 'POST'
                    });
                    const data = await response.json();
                    
                    if (data.status === 'success') {
                        setLabRunning(true);
                        setStartTime(Date.now());
                        setStage('challenge');
                        setTerminalHistory([
                            { type: 'success', text: '═══════════════════════════════════════════════════════' },
                            { type: 'success', text: '     PASSWORD CRACKING LAB - PENETRATION TESTING      ' },
                            { type: 'success', text: '═══════════════════════════════════════════════════════' },
                            { type: 'output', text: '' },
                            { type: 'output', text: `Welcome to cracking-station` },
                            { type: 'output', text: `Login: ${data.username} / ${data.password}` },
                            { type: 'output', text: '' },
                            { type: 'warning', text: 'MISSION: You obtained hash dumps from a compromised server.' },
                            { type: 'warning', text: 'OBJECTIVE: Crack as many passwords as possible to demonstrate weak security.' },
                            { type: 'output', text: '' },
                            { type: 'output', text: 'AVAILABLE COMMANDS:' },
                            { type: 'output', text: '  help       - Show detailed help' },
                            { type: 'output', text: '  hint       - Get a hint' },
                            { type: 'output', text: '  files      - List available hash files and wordlists' },
                            { type: 'output', text: '  submit     - Submit your results when done' },
                            { type: 'output', text: '' },
                            { type: 'output', text: 'TIP: Start by exploring /hashes/ and /wordlists/ directories' },
                            { type: 'output', text: '' }
                        ]);
                    } else {
                        alert(`Error starting lab: ${data.message}`);
                    }
                } catch (error) {
                    alert(`Error: ${error.message}`);
                } finally {
                    setLoading(false);
                }
            };

            const executeCommand = async (cmd) => {
                if (!cmd.trim()) return;

                setCommandHistory(prev => [...prev, cmd]);
                setHistoryIndex(-1);

                setTerminalHistory(prev => [...prev, 
                    { type: 'prompt', text: `pentester@cracking-station:~$ ${cmd}` }
                ]);

                // Built-in commands
                if (cmd === 'help') {
                    setTerminalHistory(prev => [...prev,
                        { type: 'output', text: '═══════════════════════ HELP ═══════════════════════' },
                        { type: 'output', text: '' },
                        { type: 'warning', text: 'SCENARIO COMMANDS:' },
                        { type: 'output', text: '  files    - List hash files and wordlists' },
                        { type: 'output', text: '  hint     - Get progressive hints' },
                        { type: 'output', text: '  submit   - Submit cracked passwords' },
                        { type: 'output', text: '  clear    - Clear terminal' },
                        { type: 'output', text: '' },
                        { type: 'warning', text: 'LINUX COMMANDS:' },
                        { type: 'output', text: '  ls       - List files' },
                        { type: 'output', text: '  cat      - Read file contents' },
                        { type: 'output', text: '  cd       - Change directory' },
                        { type: 'output', text: '  pwd      - Print working directory' },
                        { type: 'output', text: '' },
                        { type: 'warning', text: 'CRACKING TOOLS:' },
                        { type: 'output', text: '  john     - John the Ripper (simple, beginner-friendly)' },
                        { type: 'output', text: '  hashcat  - Hashcat (advanced, faster)' },
                        { type: 'output', text: '' },
                        { type: 'warning', text: 'EXAMPLE WORKFLOWS:' },
                        { type: 'success', text: '1. Identify hash type:' },
                        { type: 'output', text: '   cat /hashes/company_dump_md5.txt' },
                        { type: 'success', text: '2. Check wordlists:' },
                        { type: 'output', text: '   ls -lh /wordlists/' },
                        { type: 'success', text: '3. Crack with john:' },
                        { type: 'output', text: '   john --format=Raw-MD5 --wordlist=/wordlists/common-1k.txt /hashes/company_dump_md5.txt' },
                        { type: 'success', text: '4. View results:' },
                        { type: 'output', text: '   john --show /hashes/company_dump_md5.txt' },
                        { type: 'output', text: '' },
                        { type: 'warning', text: 'OR with hashcat:' },
                        { type: 'output', text: '   hashcat -m 0 /hashes/company_dump_md5.txt /wordlists/common-1k.txt --force' },
                        { type: 'output', text: '   hashcat -m 0 /hashes/company_dump_md5.txt --show' },
                        { type: 'output', text: '' }
                    ]);
                    return;
                }

                if (cmd === 'clear') {
                    setTerminalHistory([]);
                    return;
                }

                if (cmd === 'files') {
                    try {
                        const response = await fetch(`${API_BASE}/hashcrack/hint/${hintNum}`);
                        const data = await response.json();
                        
                        if (data.status === 'success') {
                            setHintsUsed(hintNum);
                            setTerminalHistory(prev => [...prev,
                                { type: 'warning', text: `═══════ HINT ${hintNum}: ${data.hint.title} ═══════` },
                                { type: 'output', text: data.hint.hint },
                                { type: 'output', text: '' },
                                { type: 'success', text: 'Suggested commands:' },
                                ...data.hint.commands.map(c => ({ type: 'output', text: `  ${c}` })),
                                { type: 'output', text: '' }
                            ]);
                        }
                    } catch (error) {
                        setTerminalHistory(prev => [...prev,
                            { type: 'error', text: `Error fetching hint: ${error.message}` }
                        ]);
                    }
                    return;
                }

                if (cmd === 'submit') {
                    submitResults();
                    return;
                }

                // Execute command on server
                setLoading(true);
                try {
                    const response = await fetch(`${API_BASE}/hashcrack/execute`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ command: cmd })
                    });
                    const data = await response.json();
                    
                    if (data.status === 'success') {
                        const outputLines = data.output.split('\n').map(line => {
                            // Highlight cracked passwords
                            if (line.includes(':') && !line.startsWith('Warning') && !line.startsWith('Session')) {
                                return { type: 'cracked', text: line };
                            }
                            return { type: 'output', text: line };
                        });
                        setTerminalHistory(prev => [...prev, ...outputLines]);
                        
                        // Count cracked passwords
                        if (data.cracked_found) {
                            const matches = data.output.match(/:/g);
                            if (matches) {
                                setCrackedCount(prev => Math.max(prev, matches.length));
                            }
                        }
                    } else {
                        setTerminalHistory(prev => [...prev,
                            { type: 'error', text: data.message || 'Command execution failed' }
                        ]);
                    }
                } catch (error) {
                    setTerminalHistory(prev => [...prev,
                        { type: 'error', text: `Error: ${error.message}` }
                    ]);
                } finally {
                    setLoading(false);
                }
            };

            const submitResults = async () => {
                const timeTaken = startTime ? Math.floor((Date.now() - startTime) / 1000) : 0;
                
                // Prompt user for tool used
                const tool = prompt('Which tool did you primarily use? (john/hashcat/both):', 'john');
                
                try {
                    const response = await fetch(`${API_BASE}/hashcrack/submit-results`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            cracked_passwords: Array(crackedCount).fill('placeholder'),
                            time_taken: timeTaken,
                            hints_used: hintsUsed,
                            tool_used: tool || 'unknown'
                        })
                    });
                    const data = await response.json();
                    
                    if (data.status === 'success') {
                        setScore(data);
                        setStage('results');
                    }
                } catch (error) {
                    setTerminalHistory(prev => [...prev,
                        { type: 'error', text: `Error submitting results: ${error.message}` }
                    ]);
                }
            };

            const handleKeyDown = (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    executeCommand(currentCommand);
                    setCurrentCommand('');
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    if (commandHistory.length > 0) {
                        const newIndex = historyIndex + 1;
                        if (newIndex < commandHistory.length) {
                            setHistoryIndex(newIndex);
                            setCurrentCommand(commandHistory[commandHistory.length - 1 - newIndex]);
                        }
                    }
                } else if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    if (historyIndex > 0) {
                        const newIndex = historyIndex - 1;
                        setHistoryIndex(newIndex);
                        setCurrentCommand(commandHistory[commandHistory.length - 1 - newIndex]);
                    } else {
                        setHistoryIndex(-1);
                        setCurrentCommand('');
                    }
                }
            };

            // INTRO STAGE
            if (stage === 'intro') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-purple-50 to-indigo-50 p-6">
                        <div className="max-w-4xl mx-auto">
                            <nav className="bg-white rounded-lg shadow-sm px-6 py-4 mb-8">
                                <div className="flex justify-between items-center">
                                    <h1 className="text-2xl font-bold bg-gradient-to-r from-purple-600 to-indigo-600 bg-clip-text text-transparent">
                                        Password Cracking Lab
                                    </h1>
                                    <a href="simulator.html" className="px-4 py-2 text-gray-700 hover:text-gray-900 transition">
                                        ← Back to Training
                                    </a>
                                </div>
                            </nav>

                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-6">
                                <div className="flex items-center justify-center mb-6">
                                    <div className="w-20 h-20 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-full flex items-center justify-center">
                                        <svg className="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                                        </svg>
                                    </div>
                                </div>

                                <h2 className="text-3xl font-bold text-center text-gray-900 mb-4">
                                    Real Password Cracking Lab
                                </h2>
                                <p className="text-center text-gray-600 mb-8">
                                    Use actual tools (hashcat, john) to crack real password hashes
                                </p>

                                <div className="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6">
                                    <h3 className="font-semibold text-blue-900 mb-2">What You'll Practice:</h3>
                                    <ul className="space-y-2 text-sm text-blue-800">
                                        <li>• Identifying hash types (MD5, SHA-1, NTLM)</li>
                                        <li>• Using industry-standard cracking tools (hashcat, john)</li>
                                        <li>• Selecting appropriate wordlists and attack methods</li>
                                        <li>• Understanding password security weaknesses</li>
                                        <li>• Real-world penetration testing workflow</li>
                                    </ul>
                                </div>

                                <div className="bg-gray-50 rounded-lg p-6 mb-6">
                                    <h3 className="font-semibold text-gray-900 mb-4">Scenario:</h3>
                                    <p className="text-gray-700 mb-3">
                                        You're a penetration tester conducting an <strong>authorized</strong> security audit. 
                                        During the assessment, you obtained password hash dumps from a database.
                                    </p>
                                    <p className="text-gray-700">
                                        Your objective: Crack as many passwords as possible to demonstrate weak password 
                                        policies and provide recommendations for improvement.
                                    </p>
                                </div>

                                <div className="bg-yellow-50 border-2 border-yellow-400 rounded-lg p-6 mb-6">
                                    <div className="flex items-start">
                                        <svg className="w-6 h-6 text-yellow-600 mr-3 flex-shrink-0 mt-1" fill="currentColor" viewBox="0 0 20 20">
                                            <path fillRule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clipRule="evenodd" />
                                        </svg>
                                        <div>
                                            <h3 className="font-bold text-yellow-900 mb-2">CRITICAL ETHICAL AND LEGAL NOTICE</h3>
                                            <div className="text-sm text-yellow-900 space-y-2">
                                                <p className="font-semibold">This is AUTHORIZED SECURITY TESTING in a controlled lab.</p>
                                                <p><strong>YOU MUST UNDERSTAND:</strong></p>
                                                <ul className="list-disc ml-5 space-y-1">
                                                    <li>Cracking passwords without authorization is <strong>ILLEGAL</strong></li>
                                                    <li>Possessing cracking tools with intent to commit crime = <strong>CRIMINAL OFFENSE</strong></li>
                                                    <li>This lab contains SIMULATED hashes for educational purposes</li>
                                                    <li>Real-world password auditing requires written authorization</li>
                                                    <li>Violations can result in severe legal consequences</li>
                                                </ul>
                                                <p className="font-semibold mt-3">
                                                    These tools are used by security professionals in legitimate penetration testing. 
                                                    Always ensure you have explicit written permission before testing any system.
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div className="flex items-center justify-center mb-6">
                                    <label className="flex items-center cursor-pointer">
                                        <input 
                                            type="checkbox" 
                                            checked={acceptedEthics}
                                            onChange={(e) => setAcceptedEthics(e.target.checked)}
                                            className="w-5 h-5 mr-3"
                                        />
                                        <span className="text-gray-900 font-medium">
                                            I understand and will only use these skills in authorized contexts
                                        </span>
                                    </label>
                                </div>

                                <button
                                    onClick={startLab}
                                    disabled={!acceptedEthics || loading}
                                    className={`w-full py-4 rounded-lg font-bold text-lg transition ${
                                        acceptedEthics && !loading
                                            ? 'bg-gradient-to-r from-purple-500 to-indigo-600 text-white hover:from-purple-600 hover:to-indigo-700' 
                                            : 'bg-gray-300 text-gray-500 cursor-not-allowed'
                                    }`}
                                >
                                    {loading ? 'Starting Lab...' : acceptedEthics ? 'Launch Cracking Lab' : 'Please Accept Terms to Continue'}
                                </button>
                            </div>
                        </div>
                    </div>
                );
            }

            // CHALLENGE STAGE
            if (stage === 'challenge') {
                return (
                    <div className="min-h-screen bg-gray-900 p-6">
                        <div className="max-w-7xl mx-auto">
                            <nav className="bg-gray-800 rounded-lg shadow-lg px-6 py-4 mb-6">
                                <div className="flex justify-between items-center">
                                    <h1 className="text-2xl font-bold text-white">Password Cracking Lab</h1>
                                    <div className="flex items-center space-x-4">
                                        <div className="text-sm text-gray-300">
                                            <span>Hints Used:</span>
                                            <span className="ml-2 font-bold text-yellow-400">{hintsUsed}/7</span>
                                        </div>
                                        <div className="text-sm text-gray-300">
                                            <span>Cracked:</span>
                                            <span className="ml-2 font-bold text-green-400">{crackedCount}</span>
                                        </div>
                                    </div>
                                </div>
                            </nav>

                            <div className="grid grid-cols-1 lg:grid-cols-4 gap-6">
                                {/* Terminal */}
                                <div className="lg:col-span-3">
                                    <div className="bg-gray-800 rounded-lg shadow-xl overflow-hidden">
                                        <div className="bg-gray-700 px-4 py-2 flex items-center justify-between">
                                            <div className="flex items-center space-x-2">
                                                <div className="w-3 h-3 bg-red-500 rounded-full"></div>
                                                <div className="w-3 h-3 bg-yellow-500 rounded-full"></div>
                                                <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                                                <span className="ml-4 text-gray-300 text-sm font-mono">
                                                    pentester@cracking-station:~
                                                </span>
                                            </div>
                                            <button
                                                onClick={() => setTerminalHistory([])}
                                                className="text-gray-400 hover:text-white text-sm"
                                            >
                                                Clear
                                            </button>
                                        </div>
                                        
                                        <div 
                                            ref={terminalRef}
                                            className="terminal"
                                            onClick={() => inputRef.current?.focus()}
                                        >
                                            {terminalHistory.map((line, index) => (
                                                <div key={index} className={`terminal-line ${line.type}`}>
                                                    {line.text}
                                                </div>
                                            ))}
                                            
                                            {!loading && (
                                                <div className="flex items-center">
                                                    <span className="prompt">pentester@cracking-station:~$ </span>
                                                    <input
                                                        ref={inputRef}
                                                        type="text"
                                                        value={currentCommand}
                                                        onChange={(e) => setCurrentCommand(e.target.value)}
                                                        onKeyDown={handleKeyDown}
                                                        className="terminal-input"
                                                        autoFocus
                                                        disabled={loading}
                                                    />
                                                </div>
                                            )}
                                            
                                            {loading && (
                                                <div className="terminal-line output">Executing command...</div>
                                            )}
                                        </div>
                                    </div>
                                </div>

                                {/* Sidebar */}
                                <div className="space-y-6">
                                    <div className="bg-gray-800 rounded-lg shadow-xl p-6">
                                        <h3 className="text-lg font-bold text-white mb-4">Objective</h3>
                                        <div className="space-y-3 text-sm text-gray-300">
                                            <div>• Identify hash types</div>
                                            <div>• Select cracking tools</div>
                                            <div>• Choose wordlists</div>
                                            <div>• Crack passwords</div>
                                            <div>• Submit results</div>
                                        </div>
                                    </div>

                                    <div className="bg-gray-800 rounded-lg shadow-xl p-6">
                                        <h3 className="text-lg font-bold text-white mb-4">Quick Commands</h3>
                                        <div className="space-y-2 text-sm">
                                            <button
                                                onClick={() => setCurrentCommand('help')}
                                                className="w-full text-left px-3 py-2 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 transition font-mono"
                                            >
                                                help
                                            </button>
                                            <button
                                                onClick={() => setCurrentCommand('files')}
                                                className="w-full text-left px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition font-mono"
                                            >
                                                files
                                            </button>
                                            <button
                                                onClick={() => setCurrentCommand('hint')}
                                                className="w-full text-left px-3 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 transition font-mono"
                                            >
                                                hint
                                            </button>
                                            <button
                                                onClick={() => setCurrentCommand('ls /hashes/')}
                                                className="w-full text-left px-3 py-2 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 transition font-mono text-xs"
                                            >
                                                ls /hashes/
                                            </button>
                                        </div>
                                        
                                        {crackedCount > 0 && (
                                            <button
                                                onClick={() => executeCommand('submit')}
                                                className="w-full mt-4 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-semibold"
                                            >
                                                Submit Results
                                            </button>
                                        )}
                                    </div>

                                    <div className="bg-purple-900 bg-opacity-50 rounded-lg p-4">
                                        <h3 className="text-sm font-semibold text-purple-200 mb-2">Tools Available</h3>
                                        <ul className="text-xs text-purple-100 space-y-1">
                                            <li>• john - Simple & effective</li>
                                            <li>• hashcat - Advanced & fast</li>
                                            <li>• Multiple wordlists</li>
                                            <li>• Hash identification tools</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // RESULTS STAGE  
            if (stage === 'results') {
                const timeTaken = startTime ? Math.floor((Date.now() - startTime) / 1000) : 0;
                const minutes = Math.floor(timeTaken / 60);
                const seconds = timeTaken % 60;

                return (
                    <div className="min-h-screen bg-gradient-to-br from-gray-50 to-blue-50 p-6">
                        <div className="max-w-5xl mx-auto">
                            <nav className="bg-white rounded-lg shadow-sm px-6 py-4 mb-8">
                                <div className="flex justify-between items-center">
                                    <h1 className="text-2xl font-bold text-gray-900">Challenge Complete!</h1>
                                    <div className="flex space-x-3">
                                        <a 
                                            href="simulator.html"
                                            onClick={async (e) => {
                                                try {
                                                    await fetch('http://localhost:8000/hashcrack/stop', {
                                                        method: 'POST'
                                                    });
                                                } catch (err) {
                                                    console.log('Cleanup error:', err);
                                                }
                                            }}
                                            className="px-4 py-2 text-gray-700 hover:text-gray-900"
                                        >
                                            Back to Training
                                        </a>
                                        <button
                                            onClick={() => window.location.reload()}
                                            className="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"
                                        >
                                            Try Again
                                        </button>
                                    </div>
                                </div>
                            </nav>

                            <div className="bg-white rounded-2xl shadow-xl p-8 mb-6">
                                <div className="text-center mb-8">
                                    <div className={`inline-block w-24 h-24 rounded-full flex items-center justify-center mb-4 ${
                                        score.grade === 'A' ? 'bg-green-100' :
                                        score.grade === 'B' ? 'bg-blue-100' :
                                        score.grade === 'C' ? 'bg-yellow-100' :
                                        'bg-red-100'
                                    }`}>
                                        <span className={`text-5xl font-bold ${
                                            score.grade === 'A' ? 'text-green-600' :
                                            score.grade === 'B' ? 'text-blue-600' :
                                            score.grade === 'C' ? 'text-yellow-600' :
                                            'text-red-600'
                                        }`}>
                                            {score.grade}
                                        </span>
                                    </div>
                                    <h2 className="text-3xl font-bold text-gray-900 mb-2">Cracking Complete!</h2>
                                    <p className="text-gray-600">Performance Analysis</p>
                                </div>

                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                                    <div className="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-lg p-4 text-center">
                                        <div className="text-3xl font-bold text-purple-600">{score.score}</div>
                                        <div className="text-sm text-gray-600">Final Score</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-green-50 to-emerald-50 rounded-lg p-4 text-center">
                                        <div className="text-3xl font-bold text-green-600">{score.cracked_count}/{score.total_crackable}</div>
                                        <div className="text-sm text-gray-600">Cracked</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg p-4 text-center">
                                        <div className="text-3xl font-bold text-blue-600">{minutes}m {seconds}s</div>
                                        <div className="text-sm text-gray-600">Time Taken</div>
                                    </div>
                                    <div className="bg-gradient-to-br from-yellow-50 to-orange-50 rounded-lg p-4 text-center">
                                        <div className="text-3xl font-bold text-yellow-600">{score.success_rate}%</div>
                                        <div className="text-sm text-gray-600">Success Rate</div>
                                    </div>
                                </div>

                                <div className="bg-gray-50 rounded-lg p-6 mb-6">
                                    <h3 className="font-bold text-gray-900 mb-4">Score Breakdown</h3>
                                    <div className="space-y-2 text-sm">
                                        <div className="flex justify-between">
                                            <span className="text-gray-700">Base Score (passwords cracked):</span>
                                            <span className="font-bold text-green-600">+{score.base_score}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-700">Time Bonus:</span>
                                            <span className="font-bold text-blue-600">+{score.time_bonus}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-700">Tool Bonus:</span>
                                            <span className="font-bold text-purple-600">+{score.tool_bonus}</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span className="text-gray-700">Hint Penalty:</span>
                                            <span className="font-bold text-red-600">-{score.hint_penalty}</span>
                                        </div>
                                        <div className="flex justify-between pt-2 border-t-2">
                                            <span className="font-bold text-gray-900">Final Score:</span>
                                            <span className="font-bold text-purple-600 text-lg">{score.score}</span>
                                        </div>
                                    </div>
                                </div>

                                <div className="grid md:grid-cols-2 gap-6 mb-6">
                                    <div className="bg-blue-50 rounded-lg p-6">
                                        <h3 className="font-bold text-blue-900 mb-3">What You Learned</h3>
                                        <ul className="space-y-2 text-sm text-blue-800">
                                            <li>• Hash type identification (MD5, SHA-1, NTLM)</li>
                                            <li>• Industry-standard cracking tools</li>
                                            <li>• Wordlist selection strategies</li>
                                            <li>• Password pattern analysis</li>
                                            <li>• Real penetration testing workflow</li>
                                        </ul>
                                    </div>
                                    <div className="bg-green-50 rounded-lg p-6">
                                        <h3 className="font-bold text-green-900 mb-3">Defense Recommendations</h3>
                                        <ul className="space-y-2 text-sm text-green-800">
                                            <li>• Use bcrypt/scrypt/Argon2 for hashing</li>
                                            <li>• Enforce minimum password length (12+ chars)</li>
                                            <li>• Require password complexity</li>
                                            <li>• Implement MFA (Multi-Factor Auth)</li>
                                            <li>• Regular password policy audits</li>
                                        </ul>
                                    </div>
                                </div>

                                <div className="bg-yellow-50 border-l-4 border-yellow-500 p-6">
                                    <h3 className="font-bold text-yellow-900 mb-3">Key Takeaways</h3>
                                    <div className="text-sm text-yellow-800 space-y-2">
                                        <p>
                                            <strong>Weak passwords</strong> are one of the biggest security vulnerabilities. 
                                            This lab demonstrated how quickly common passwords can be cracked with readily 
                                            available tools.
                                        </p>
                                        <p>
                                            <strong>Defense strategy:</strong> Organizations must implement strong password 
                                            policies, use modern hashing algorithms, and deploy multi-factor authentication 
                                            to protect against password-based attacks.
                                        </p>
                                        <p>
                                            <strong>Penetration testing value:</strong> Regular security audits help identify 
                                            weak passwords before malicious actors can exploit them.
                                        </p>
                                    </div>
                                </div>

                                <div className="flex justify-center space-x-4 mt-8">
                                    <a
                                        href="simulator.html"
                                        onClick={async (e) => {
                                            try {
                                                await fetch('http://localhost:8000/hashcrack/stop', {
                                                    method: 'POST'
                                                });
                                            } catch (err) {
                                                console.log('Cleanup error:', err);
                                            }
                                        }}
                                        className="px-6 py-3 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-medium"
                                    >
                                        Back to Training Center
                                    </a>
                                    <button
                                        onClick={() => window.location.reload()}
                                        className="px-6 py-3 bg-gradient-to-r from-purple-500 to-indigo-600 text-white rounded-lg hover:from-purple-600 hover:to-indigo-700 font-medium"
                                    >
                                        Try Again
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }
        };

        ReactDOM.render(React.createElement(PasswordCrackingLab), document.getElementById('root'));
    </script>
</body>
</html>hashcrack/files`);
                        const data = await response.json();
                        
                        if (data.status === 'success') {
                            setTerminalHistory(prev => [...prev,
                                { type: 'warning', text: '═══════ HASH FILES ═══════' },
                                { type: 'output', text: data.hash_files },
                                { type: 'warning', text: '═══════ WORDLISTS ═══════' },
                                { type: 'output', text: data.wordlists },
                                { type: 'output', text: '' }
                            ]);
                        }
                    } catch (error) {
                        setTerminalHistory(prev => [...prev,
                            { type: 'error', text: `Error: ${error.message}` }
                        ]);
                    }
                    return;
                }

                if (cmd.startsWith('hint')) {
                    const hintNum = hintsUsed + 1;
                    if (hintNum > 7) {
                        setTerminalHistory(prev => [...prev,
                            { type: 'warning', text: 'No more hints available!' }
                        ]);
                        return;
                    }
                    
                    try {
                        const response = await fetch(`${API_BASE}/
